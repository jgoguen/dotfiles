# vim: set filetype=zsh:
# Do not edit this file directly! It is managed by chezmoi.

if [ -z "${TERM}" ] || [ "${TERM}" = "vscode" ] || [[ ! -o interactive ]]; then
	return
fi

# Disable WezTerm user var integrations in neovim:
# https://github.com/wezterm/wezterm/issues/5007
# For some reason this isn't working unless it's disabled in the base terminal
# before starting neovim.
export WEZTERM_SHELL_SKIP_ALL=1

RC_START=${SECONDS}

export USER_ZSH="${XDG_DATA_HOME}/zsh"
export ZSH_CACHE_DIR="${XDG_CACHE_HOME}/zsh"

for f in "${USER_ZSH}"/conf.d/pre/*.zsh; do
	source "${f}"
done

for f in "${USER_ZSH}"/conf.d/*.zsh; do
	source "${f}"
done

for f in "${USER_ZSH}"/conf.d/post/*.zsh; do
	source "${f}"
done

{{ if eq .chezmoi.os "darwin" -}}
unset BREW_PREFIX
{{- end }}
unset USER_ZSH
unset ZSH_CACHE_DIR

if [ -f "${HOME}/.zshrc.local" ]; then
	. "${HOME}/.zshrc.local"
fi

if (( $+commands[direnv] )); then
	eval "$(direnv hook zsh)"
fi

RC_TIME=$(($SECONDS - $RC_START))
printf 'Shell startup took %s\n' "$(elapsed-time $RC_TIME)"
