# vim: set noexpandtab tabstop=2 shiftwidth=2 autoindent:
# vim: set foldmarker=[[[,]]] foldmethod=marker foldlevel=0:
# Do not edit this file directly! It is managed by chezmoi.

if [ -z "${TERM}" ] || [ "${TERM}" = "vscode" ] || [[ ! -o interactive ]]; then
	return
fi

autoload zkbd
[ ! -f "${ZDOTDIR:-$HOME}/.zkbd/$TERM" ] && {
	zkbd
	# shellcheck disable=SC2039
	mv "${ZDOTDIR:-$HOME}/.zkbd/$TERM-${${DISPLAY:t}:-$VENDOR-$OSTYPE}" "${ZDOTDIR:-$HOME}/.zkbd/$TERM"
}
# shellcheck source={{ .chezmoi.homeDir }}/.zkbd/xterm-256color
. "${ZDOTDIR:-$HOME}/.zkbd/$TERM"

[ -n "${key[Backspace]}" ] && bindkey "${key[Backspace]}" backward-delete-char
[ -n "${key[Insert]}" ] && bindkey "${key[Insert]}" overwrite-mode
[ -n "${key[Home]}" ] && bindkey "${key[Home]}" beginning-of-line
[ -n "${key[PageUp]}" ] && bindkey "${key[PageUp]}" up-line-or-history
[ -n "${key[Delete]}" ] && bindkey "${key[Delete]}" delete-char
[ -n "${key[End]}" ] && bindkey "${key[End]}" end-of-line
[ -n "${key[PageDown]}" ] && bindkey "${key[PageDown]}" down-line-or-history
[ -n "${key[Up]}" ] && bindkey "${key[Up]}" up-line-or-search
[ -n "${key[Left]}" ] && bindkey "${key[Left]}" backward-char
[ -n "${key[Down]}" ] && bindkey "${key[Down]}" down-line-or-search
[ -n "${key[Right]}" ] && bindkey "${key[Right]}" forward-char

# Scroll up in tmux on PageUp.
_tmux_copy_mode() {
	tmux copy-mode -eu
}
zle -N _tmux_copy_mode
[[ $TMUX_PANE && -n "${key[PageUp]}" ]] && bindkey "${key[PageUp]}" _tmux_copy_mode

# Print out some stuff before the terminal prompt
uptime
printf "\n"
FORTUNE="$(command -v fortune)"
if [ -n "${FORTUNE}" ]; then
	"${FORTUNE}" -n 512 -s
fi
