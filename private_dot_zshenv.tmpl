# vim: set filetype=zsh:
# Do not edit this file directly! It is managed by chezmoi.

# Set XDG variables for UNIX apps. Use Linux-standard paths even on macOS
# because chezmoi can't deploy to a different location per OS.
export XDG_CACHE_HOME="${HOME}/.cache"
export XDG_CONFIG_HOME="${HOME}/.config"
export XDG_DATA_HOME="${HOME}/.local/share"
export XDG_STATE_HOME="${HOME}/.local/state"

if [ ! -w "${XDG_RUNTIME_DIR:="/run/user/$(id -u)"}" ]; then
	XDG_RUNTIME_DIR="/tmp"
fi
export XDG_RUNTIME_DIR

for dname in "${XDG_CACHE_HOME}" "${XDG_CONFIG_HOME}" "${XDG_DATA_HOME}" "${XDG_STATE_HOME}"; do
	if [ ! -d "${dname}" ]; then
		/usr/bin/install -d -m 0700 "${dname}"
	fi
done

: "${KITTY_WINDOW_ID:=""}"
if [ -n "${KITTY_WINDOW_ID}" ]; then
	export TERM=vte-256color
fi

export FZF_DEFAULT_OPTS=" \
	--height=~40% --layout=reverse --border --select-1 --exit-0 \
	--color=bg+:#313244,bg:#1e1e2e,spinner:#f5e0dc,hl:#f38ba8 \
	--color=fg:#cdd6f4,header:#f38ba8,info:#cba6f7,pointer:#f5e0dc \
	--color=marker:#f5e0dc,fg+:#cdd6f4,prompt:#cba6f7,hl+:#f38ba8 \
"

export GTK_IM_MODULE="ibus"
export HISTFILE="${XDG_CACHE_HOME}/zsh_history"
export HISTSIZE=250000000

if [ ! -f "${HISTFILE}" ]; then
	/usr/bin/install -D -m 0600 /dev/null "${HISTFILE}"
fi

export LG_CONFIG_FILE="${XDG_CONFIG_HOME}/lazygit/config.yml,${XDG_CONFIG_HOME}/lazygit/catppuccin-mocha-mauve.yaml"

export MAILCHECK=0
export PAGER="less -FRXd"
export PROMPT_RETURNCODE_PREFIX="%{$fg_bold[red]%}"
export RIPGREP_CONFIG_PATH="${XDG_CONFIG_HOME}/ripgrep.conf"
export QT_IM_MODULE="ibus"
export SAVEHIST=${HISTSIZE}

{{- if eq .chezmoi.os "linux" }}
export SNAP_USER_COMMON="${XDG_CONFIG_HOME}/snaps"
export SNAP_USER_DATA="${XDG_CONFIG_HOME}/snaps"

{{- if ne .environment "headless" }}
# Force 1Password CLI to use app integration
export OP_BIOMETRIC_UNLOCK_ENABLED=true
{{- end }}
{{- end }}

if [ -S "${HOME}/.1password/agent.sock" ]; then
	export SSH_AUTH_SOCK="${HOME}/.1password/agent.sock"
fi

export TEXMFCONFIG="${XDG_CONFIG_HOME}/texlive"
export TEXMFHOME="${XDG_DATA_HOME}/texlive/texmf"
export TEXMFVAR="${XDG_DATA_HOME}/texlive/var"

export XMODIFIERS="@im=ibus"

if [ ! -d "${TEXMFCONFIG}" ]; then
	/usr/bin/install -d -m 0700 "${TEXMFCONFIG}"
fi

NODE_PATH="${HOME}/.local/lib/node_modules:${NODE_PATH}"
export NODE_PATH

export LC_ALL="en_CA.UTF-8"
export LANG="en_CA.UTF-8"

if [ -f "${HOME}/.zshenv.local" ]; then
	. "${HOME}/.zshenv.local"
fi
