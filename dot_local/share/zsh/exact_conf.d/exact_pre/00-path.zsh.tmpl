# vim: set filetype=sh:
# Do not edit this file directly! It is managed by chezmoi.

if [[ -n "${NVIM}" && -S "${NVIM}" ]]; then
	return
fi

# Set path first, so many other things depend on it
typeset -U path
typeset -aU path_dirs
path_dirs=(
	/sbin
	/bin
	/usr/sbin
	/usr/bin
	/usr/local/sbin
	/usr/local/bin
	/var/lib/snapd/snap/bin
	/usr/local/go/bin
	/usr/local/nodejs/current/bin
	/opt/local/sbin
	/opt/local/bin
	/opt/homebrew/sbin
	/opt/homebrew/bin
	"${HOME}/.cargo/bin"
	"${HOME}/.dotnet/tools"
	"${HOME}/bin"
	"${HOME}/.local/bin"
)

for bindir in "${path_dirs[@]}"; do
	if [ -d "${bindir}" ] && [ -r "${bindir}" ] && [ -x "${bindir}" ]; then
		binpath="$(realpath "${bindir}" 2>/dev/null || true)"
		if [ -n "${binpath}" ]; then
			path=("${binpath}" ${path})
		fi
	fi
done

if [ -f '/opt/google-cloud-sdk/completion.zsh.inc' ]; then
	source '/opt/google-cloud-sdk/completion.zsh.inc'
fi
if [ -f '/opt/google-cloud-sdk/path.zsh.inc' ]; then
	source '/opt/google-cloud-sdk/path.zsh.inc'
fi

# Add paths for languages
# Add Go paths
# {{- if eq .chezmoi.os "darwin" }}
export GOPATH="${HOME}/Library/Application Support/go"
{{- else }}
export GOPATH="${XDG_STATE_HOME}/go"
{{- end }}
while read -d ':' pathname || [ -n "${pathname}" ]; do
	if [ ! -d "${pathname}" ]; then
		/usr/bin/install -d -m 0700 "${pathname}/bin"
	fi
	path=(${pathname}/bin ${path})
done < <(printf '%s' "${GOPATH}")

export PATH

if (( ${+commands[clang]} )); then
	export CC="${commands[clang]}"
fi

if (( ${+commands[nvim]} )); then
	export EDITOR="${commands[nvim]}"
elif (( ${+commands[vim]} )); then
	export EDITOR="${commands[vim]}"
else
	export EDITOR=vi
fi
export VISUAL="${EDITOR:-vi}"

if (( ${+commands[manpath]} )) && [ -z "${MANPATH}" ]; then
	MANPATH="${XDG_DATA_HOME}/man:/opt/local/share/man:$(manpath 2>/dev/null)"
	export MANPATH
fi
