-- Do not edit this file directly! It is managed by chezmoi.

local Utils = require('utils')

local M = {
	{
		'nvim-neorg/neorg',
		cond = function()
			return Utils.has_tool('luarocks') or Utils.has_tool('hererocks')
		end,
		ft = { 'norg' },
		dependencies = {
			{
				'nvim-neorg/tree-sitter-norg',
				cond = function()
					return Utils.has_tool('luarocks') or Utils.has_tool('hererocks')
				end,
				build = {
					'rockspec',
					function()
						local from = vim.fn.stdpath('data') .. '/lazy-rocks/tree-sitter-norg/lib/lua/5.1/parser/norg.so'
						local to = vim.fn.stdpath('data') .. '/site/parser/norg.so'
						vim.fn.mkdir(vim.fn.fnamemodify(to, ':p:h'), 'p')

						local ok, err, err_name = vim.uv.fs_link(from, to)
						if not ok then
							vim.notify(
								('copy %s to %s failed for %s %s'):format(from, to, err, err_name),
								vim.log.levels.ERROR,
								{ title = 'tree-sitter-norg' }
							)
						else
							vim.notify(
								('link %s to %s success'):format(from, to),
								vim.log.levels.INFO,
								{ title = 'tree-sitter-norg' }
							)
						end
					end,
				},
			},
		},
		lazy = false,
		opts = {
			load = {
				['core.defaults'] = {},

				['core.concealer'] = {},
				['core.dirman'] = {
					config = {
						workspaces = {
							notes = '~/Nextcloud/Notes',
						},
						default_workspace = 'notes',
					},
				},
				['core.esupports.indent'] = {},
				['core.esupports.metagen'] = {
					config = {
						timezone = 'implicit-local',
						type = 'auto',
						update_date = true,
					},
				},
				['core.export'] = {
					config = {
						export_dir = os.getenv('HOME') .. '/Documents',
					},
				},
				['external.context'] = {},
			},
		},
	},
}

return M
