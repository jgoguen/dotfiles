-- Do not edit this file directly! It is managed by chezmoi.

local M = {
	'neovim/nvim-lspconfig',
	opts = function(_, opts)
		opts['servers']['basedpyright'] = {
			enabled = true,
			settings = {
				exclude = {
					'venv',
					'.venv',
				},
				basedpyright = {
					analysis = {
						autoImportCompletions = true,
						autoSearchPaths = true,
						diagnosticMode = 'workspace',
						useLibraryCodeForTypes = true,
					},
				},
			},
		}

		local venv_paths = {
			'./venv',
			'./.venv',
			'./env',
		}
		for _, candidate in ipairs(venv_paths) do
			if vim.fn.isdirectory(candidate) == 1 then
				opts['servers']['basedpyright']['settings']['python'] = opts['servers']['basedpyright']['settings']['python']
					or {}
				opts['servers']['basedpyright']['settings']['python']['pythonPath'] = candidate .. '/bin/python3'
				break
			end
		end
	end,
}

return M
